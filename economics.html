<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Economics â€” JojoJubah</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <!-- Use complete site styles with AI chatbot integration -->
  <link rel="stylesheet" href="css/style.css">
  
  <!-- Market Ticker Styles -->
  <style>
    #market-banner {
      background: linear-gradient(90deg, rgba(34, 197, 94, 0.15), rgba(16, 185, 129, 0.1));
      border-top: 2px solid rgba(34, 197, 94, 0.3);
      border-bottom: 2px solid rgba(34, 197, 94, 0.3);
      padding: 0;
      margin: 2rem 0;
      overflow: hidden;
      height: 50px;
      display: flex;
      align-items: center;
      position: relative;
    }

    .ticker-container {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      position: relative;
    }

    .ticker-content {
      flex: 1;
      height: 100%;
      overflow: hidden;
      position: relative;
      display: flex;
      align-items: center;
    }

    .ticker-wrapper {
      display: flex;
      width: max-content;
      animation: ticker-scroll 30s linear infinite;
      will-change: transform;
    }

    .ticker-track {
      display: flex;
    }

    .ticker-item {
      padding: 0 2rem;
      font-size: 1rem;
      font-weight: 500;
      white-space: nowrap;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* âœ… FIX: seamless hand-off between duplicate tracks */
    @keyframes ticker-scroll {
      0%   { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    .ticker-refresh {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(34, 197, 94, 0.1);
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 6px;
      padding: 8px 10px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.9rem;
      z-index: 10;
    }

    .ticker-refresh:hover:not(:disabled) {
      background: rgba(34, 197, 94, 0.2);
      border-color: rgba(34, 197, 94, 0.5);
      transform: translateY(-50%) scale(1.05);
    }

    .ticker-refresh:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .ticker-refresh.loading .refresh-icon {
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Pause animation on hover */
    #market-banner:hover .ticker-wrapper {
      animation-play-state: paused;
      -webkit-animation-play-state: paused;
    }

    /* Dark mode support */
    body[data-theme="dark"] #market-banner {
      background: linear-gradient(90deg, rgba(34, 197, 94, 0.2), rgba(16, 185, 129, 0.15));
      border-color: rgba(34, 197, 94, 0.4);
    }

    body[data-theme="dark"] .ticker-refresh {
      background: rgba(34, 197, 94, 0.15);
      border-color: rgba(34, 197, 94, 0.4);
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      #market-banner {
        height: 40px;
        margin: 1rem 0;
      }
      
      .ticker-wrapper {
        animation: ticker-scroll 25s linear infinite;
      }
      
      .ticker-item {
        font-size: 0.85rem;
        padding: 0 1rem;
        justify-content: center;
      }
      
      .ticker-refresh {
        padding: 6px 8px;
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body>
  <!-- Background -->
  <div class="background-gradient"></div>

  <!-- Nav (updated links to main website) -->
  <nav id="navbar">
    <div class="container">
      <div class="nav-container">
        <div class="logo-area">
          <img src="favicon.png" alt="JojoJubah" class="site-avatar"/>
          <span class="logo-text">JojoJubah</span>
        </div>
        <ul class="nav-links">
          <li><a href="index.html#home" class="nav-link">Home</a></li>
          <li><a href="index.html#about" class="nav-link">About</a></li>
          <li><a href="index.html#learn" class="nav-link">Learn</a></li>
          <li><a href="index.html#projects" class="nav-link">Projects</a></li>
          <li><a href="index.html#economics" class="nav-link">Economics</a></li>
          <li><a href="index.html#contact" class="nav-link">Contact</a></li>
        </ul>
        <button class="mobile-menu-button" id="mobileMenuBtn">
          <div class="hamburger"></div><div class="hamburger"></div><div class="hamburger"></div>
        </button>
      </div>
    </div>
  </nav>

  <main>
    <!-- Hero -->
    <section id="home" style="min-height:60vh;display:flex;align-items:center;justify-content:center;text-align:center">
      <div class="container">
        <h1 class="hero-title">Welcome to <span class="gradient-text">Economics</span></h1>
        <p class="hero-subtitle">Plain-English notes on money, markets, and decisionsâ€”made for creators.</p>
        <p class="hero-subtitle" style="font-size:1rem;margin-top:0.5rem;opacity:0.8">ðŸ’¡ Ask the AI assistant about any economic concept!</p>
      </div>
    </section>

    <!-- Market Banner -->
    <section id="market-banner">
      <div class="ticker-container">
        <div class="ticker-content">
          <div class="ticker-wrapper" id="tickerWrapper">
            <div class="ticker-track" id="tickerTrack1">
              <span class="ticker-item">ðŸ“Š Loading market data...</span>
            </div>
            <!-- Duplicate track for seamless loop -->
            <div class="ticker-track" id="tickerTrack2">
              <span class="ticker-item">ðŸ“Š Loading market data...</span>
            </div>
          </div>
        </div>
        <button id="refreshBanner" class="ticker-refresh" aria-label="Refresh market data" title="Refresh market data">
          <span class="refresh-icon">ðŸ”„</span>
        </button>
      </div>
    </section>

    <!-- Starter content (unchanged) -->
    â€¦ <!-- everything else in your original file remains exactly the same -->
  </main>

  <!-- Market Banner Functionality -->
  <script type="module">
    import { getFunctions, httpsCallable } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-functions.js';
    
    const functions = getFunctions(window.app);
    const getMarketBanner = httpsCallable(functions, 'getMarketBanner');

    let isLoading = false;

    async function loadMarketBanner(showStatus = false) {
      if (isLoading) return;
      const track1 = document.getElementById('tickerTrack1');
      const track2 = document.getElementById('tickerTrack2');
      const refreshButton = document.getElementById('refreshBanner');

      try {
        isLoading = true;
        refreshButton?.setAttribute('disabled', 'true');
        refreshButton?.classList.add('loading');
        
        const result = await getMarketBanner();
        
        if (result.data && result.data.banner) {
          // âœ… FIX: split on bullet, re-add bullet between items
          const items = result.data.banner
            .split(/â€¢/g)
            .map((txt, i, arr) =>
              `<span class="ticker-item">${txt.trim()}${i < arr.length - 1 ? " â€¢" : ""}</span>`
            )
            .join("");
          track1.innerHTML = items;
          track2.innerHTML = items;
        } else {
          const fallbackText = 'ðŸ“Š No market data received';
          track1.innerHTML = `<span class="ticker-item">${fallbackText}</span>`;
          track2.innerHTML = `<span class="ticker-item">${fallbackText}</span>`;
        }
      } catch (error) {
        const errorText = 'ðŸ“Š Market data temporarily unavailable';
        track1.innerHTML = `<span class="ticker-item">${errorText}</span>`;
        track2.innerHTML = `<span class="ticker-item">${errorText}</span>`;
      } finally {
        isLoading = false;
        refreshButton?.removeAttribute('disabled');
        refreshButton?.classList.remove('loading');
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadMarketBanner(false);
      document.getElementById('refreshBanner')
        ?.addEventListener('click', () => loadMarketBanner(true));
      setInterval(() => {
        if (!document.hidden) loadMarketBanner(false);
      }, 5 * 60 * 1000);
    });
  </script>
</body>
</html>
